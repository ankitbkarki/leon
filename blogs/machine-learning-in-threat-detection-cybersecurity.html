<!DOCTYPE html><html lang="en-us"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Machine Learning in Threat Detection: How AI Is Changing Cyber Defense</title><meta name="description" content="Explore how machine learning is revolutionizing threat detection in cybersecurity. Learn how AI adapts to evolving threats, supports analysts, and changes how we defend digital systems.

"><meta name="generator" content="Publii Open-Source CMS for Static Site"><script type="text/javascript" async src="https://www.googletagmanager.com/gtag/js?id=G-1YSV5NS6SN"></script><script type="text/javascript">window.dataLayer = window.dataLayer || [];
				  function gtag(){dataLayer.push(arguments);}
				  gtag('js', new Date());
				  gtag('config', 'G-1YSV5NS6SN' );</script><link rel="canonical" href="https://leonstaff.com/blogs/machine-learning-in-threat-detection-cybersecurity.html"><link rel="alternate" type="application/atom+xml" href="https://leonstaff.com/blogs/feed.xml" title="Leon Consulting Blog - RSS"><link rel="alternate" type="application/json" href="https://leonstaff.com/blogs/feed.json" title="Leon Consulting Blog - JSON"><meta property="og:title" content="Machine Learning in Threat Detection: How AI Is Changing Cyber Defense"><meta property="og:image" content="https://leonstaff.com/blogs/media/posts/18/machine-learning-in-threat-detection-cybersecurity.png"><meta property="og:image:width" content="900"><meta property="og:image:height" content="506"><meta property="og:site_name" content="Leon Consulting Blog"><meta property="og:description" content="Explore how machine learning is revolutionizing threat detection in cybersecurity. Learn how AI adapts to evolving threats, supports analysts, and changes how we defend digital systems.

"><meta property="og:url" content="https://leonstaff.com/blogs/machine-learning-in-threat-detection-cybersecurity.html"><meta property="og:type" content="article"><link rel="preload" href="https://leonstaff.com/blogs/assets/dynamic/fonts/inter/inter.woff2" as="font" type="font/woff2" crossorigin><link rel="preload" href="https://leonstaff.com/blogs/assets/dynamic/fonts/inter/inter-italic.woff2" as="font" type="font/woff2" crossorigin><link rel="stylesheet" href="https://leonstaff.com/blogs/assets/css/style.css?v=7ddcc1993dc40afaced990f8f62028c4"><script type="application/ld+json">{"@context":"http://schema.org","@type":"Article","mainEntityOfPage":{"@type":"WebPage","@id":"https://leonstaff.com/blogs/machine-learning-in-threat-detection-cybersecurity.html"},"headline":"Machine Learning in Threat Detection: How AI Is Changing Cyber Defense","datePublished":"2025-05-02T07:57-05:00","dateModified":"2025-05-02T08:27-05:00","image":{"@type":"ImageObject","url":"https://leonstaff.com/blogs/media/posts/18/machine-learning-in-threat-detection-cybersecurity.png","height":506,"width":900},"description":"Explore how machine learning is revolutionizing threat detection in cybersecurity. Learn how AI adapts to evolving threats, supports analysts, and changes how we defend digital systems.\n\n","author":{"@type":"Person","name":"Leon","url":"https://leonstaff.com/blogs/authors/leon-staff-team/"},"publisher":{"@type":"Organization","name":"Leon","logo":{"@type":"ImageObject","url":"https://leonstaff.com/blogs/media/website/logo.png","height":100,"width":250}}}</script><noscript><style>img[loading] {
                    opacity: 1;
                }</style></noscript><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-7656339654245336" crossorigin="anonymous"></script></head><body class="post-template"><header class="header" id="js-header"><a href="https://leonstaff.com/blogs/" class="logo"><img src="https://leonstaff.com/blogs/media/website/logo.png" alt="Leon Consulting Blog" width="250" height="100"></a><nav class="navbar js-navbar"><button class="navbar__toggle js-toggle" aria-label="Menu"><span class="navbar__toggle-box"><span class="navbar__toggle-inner">Menu</span></span></button><ul class="navbar__menu"><li><a href="https://leonstaff.com" target="_self">HOME</a></li><li><a href="https://leonstaff.com/#services" target="_self">SERVICES</a></li><li><a href="https://leonstaff.com/#about" target="_self">ABOUT</a></li><li><a href="https://leonstaff.com/#contact" target="_self">CONTACT</a></li><li><a href="https://leonstaff.com/#faq" target="_self">F&amp;Q</a></li></ul></nav></header><main class="post"><div class="wrapper"><article class="content"><header class="content__header"><a href="https://leonstaff.com/blogs/tags/cybersecurity/" class="content__maintag">Cybersecurity</a><h1 class="content__title">Machine Learning in Threat Detection: How AI Is Changing Cyber Defense</h1><div class="content__posted-date"><time datetime="2025-05-02T07:57">May 2, 2025</time></div></header><figure class="content__featured-image"><img src="https://leonstaff.com/blogs/media/posts/18/machine-learning-in-threat-detection-cybersecurity.png" height="506" width="900" alt="machine-learning-in-threat-detection-cybersecurity"></figure><div class="content__inner"><div class="content__entry"><p data-start="188" data-end="585">If you’ve been paying even mild attention to cybersecurity over the past few years, you’ve likely heard something about machine learning (ML) becoming the “future” of threat detection. That phrase gets tossed around a lot, sometimes almost carelessly, but when you dig in—you realize there’s a real shift happening. The kind that quietly changes everything without most people noticing right away.</p><p data-start="587" data-end="867">So let’s break it down. Not just the tech stuff, but the bigger picture too. What’s actually changing in cyber defense with machine learning? Why does it matter? And perhaps the more practical question—how does this impact everyday businesses, IT teams, and, well, the rest of us?</p><div class="post__toc"><h3>Table of Contents</h3><ul><li><a href="#mcetoc_1iq8h54te1a6">The Problem with Traditional Cybersecurity Tools</a></li><li><a href="#mcetoc_1iq8h54te1a7">So… What Is Machine Learning Actually Doing Here?</a></li><li><a href="#mcetoc_1iq8h54te1a8">Real-World Applications (Yes, This Stuff Is Already in Use)</a><ul><li><a href="#mcetoc_1iq8h54te1a9">A Few Examples:</a></li></ul></li><li><a href="#mcetoc_1iq8h54te1aa">But Let’s Not Pretend It’s Magic</a></li><li><a href="#mcetoc_1iq8h54te1ab">Types of Machine Learning in Cybersecurity</a><ul><li><a href="#mcetoc_1iq8h54te1ac">1. Supervised Learning</a></li><li><a href="#mcetoc_1iq8h54te1ad">2. Unsupervised Learning</a></li><li><a href="#mcetoc_1iq8h54te1ae">3. Reinforcement Learning</a></li></ul></li><li><a href="#mcetoc_1iq8h54te1af">Why Now? What Changed?</a></li><li><a href="#mcetoc_1iq8h54te1ag">A Day in the Life of AI-Powered Threat Detection</a></li><li><a href="#mcetoc_1iq8h54te1ah">Benefits That Are Hard to Ignore</a></li><li><a href="#mcetoc_1iq8h54te1ai">Risks and Limitations (Because, Let’s Be Honest…)</a></li><li><a href="#mcetoc_1iq8h54te1aj">Future Outlook: Where Is This Heading?</a><ul><li><a href="#mcetoc_1iq8h54te1ak">1. Self-Healing Systems</a></li><li><a href="#mcetoc_1iq8h54te1al">2. AI vs AI</a></li><li><a href="#mcetoc_1iq8h54te1am">3. Explainable AI (XAI)</a></li></ul></li><li><a href="#mcetoc_1iq8h54te1an">Final Thoughts: This Isn’t Optional Anymore</a></li><li><a href="#mcetoc_1iq8h54te1ao">Quick FAQ</a></li></ul></div><h2 id="mcetoc_1iq8h54te1a6" data-start="874" data-end="925">The Problem with Traditional Cybersecurity Tools</h2><p data-start="927" data-end="1020">To understand what ML is “fixing,” we first have to talk about what’s been... kind of broken.</p><p data-start="1022" data-end="1245">Traditional cybersecurity tools are rule-based. Basically, someone writes a rule—like “if X type of traffic does Y, flag it.” That works, sure, but only until the bad guys change their strategy. And spoiler: they always do.</p><p data-start="1247" data-end="1466">In fact, attackers today are using automation and even their own machine learning models to launch attacks. Some even mutate malware in real-time to evade detection. That’s not science fiction anymore—it’s just Tuesday.</p><p data-start="1468" data-end="1688">So now imagine trying to catch these kinds of threats with a static set of rules. It’s a bit like trying to predict modern internet memes with a guidebook from 2007. Technically possible? Maybe. Reliable? Not even close.</p><h2 id="mcetoc_1iq8h54te1a7" data-start="1695" data-end="1749">So… What <em data-start="1707" data-end="1711">Is</em> Machine Learning Actually Doing Here?</h2><p data-start="1751" data-end="1924">Machine learning, in this context, is a subset of artificial intelligence that allows systems to “learn” from data and improve over time without being explicitly programmed.</p><p data-start="1926" data-end="1961">In threat detection, ML models can:</p><ul data-start="1962" data-end="2369"><li data-start="1962" data-end="2057"><p data-start="1964" data-end="2057">Spot patterns that humans miss (like thousands of weird-but-subtle login attempts over days).</p></li><li data-start="2058" data-end="2190"><p data-start="2060" data-end="2190">Identify anomalies in user behavior (e.g., “Why is Bob in accounting suddenly downloading server backups at 2 a.m. from Taiwan?”).</p></li><li data-start="2191" data-end="2285"><p data-start="2193" data-end="2285">Detect zero-day exploits by analyzing their behavior instead of relying on known signatures.</p></li><li data-start="2286" data-end="2369"><p data-start="2288" data-end="2369">Adapt faster than static rules—some systems even retrain themselves continuously.</p></li></ul><p data-start="2371" data-end="2525">That last point is important. The landscape shifts constantly. So a system that can evolve—without waiting for a human update—is fundamentally more agile.</p><h2 id="mcetoc_1iq8h54te1a8" data-start="2532" data-end="2594">Real-World Applications (Yes, This Stuff Is Already in Use)</h2><p data-start="2596" data-end="2808">It’s not just theoretical. In fact, if your company uses tools from CrowdStrike, Darktrace, SentinelOne, or Microsoft Defender for Endpoint, machine learning is already quietly doing a chunk of the heavy lifting.</p><h3 id="mcetoc_1iq8h54te1a9" data-start="2810" data-end="2829">A Few Examples:</h3><ul data-start="2830" data-end="3318"><li data-start="2830" data-end="2968"><p data-start="2832" data-end="2968"><strong data-start="2832" data-end="2845">Darktrace</strong> uses unsupervised ML to establish a baseline of “normal” behavior in a network and then flags deviations—even subtle ones.</p></li><li data-start="2969" data-end="3091"><p data-start="2971" data-end="3091"><strong data-start="2971" data-end="2993">CrowdStrike Falcon</strong> combines behavioral AI with threat intelligence to detect ransomware before it encrypts anything.</p></li><li data-start="3092" data-end="3208"><p data-start="3094" data-end="3208"><strong data-start="3094" data-end="3114">Google Chronicle</strong> applies ML to petabytes of log data to uncover threats across cloud and on-prem environments.</p></li><li data-start="3209" data-end="3318"><p data-start="3211" data-end="3318"><strong data-start="3211" data-end="3237">IBM QRadar with Watson</strong> uses NLP and ML to help analysts triage threats faster and reduce alert fatigue.</p></li></ul><p data-start="3320" data-end="3359">And that’s just scratching the surface.</p><h2 id="mcetoc_1iq8h54te1aa" data-start="3366" data-end="3401">But Let’s Not Pretend It’s Magic</h2><p data-start="3403" data-end="3515">There’s a temptation to oversell this technology. (Some vendors absolutely do.) So let’s slow down for a second.</p><p data-start="3517" data-end="3725">Machine learning is powerful, yes, but it’s not flawless. These systems can still produce false positives. They can sometimes miss very subtle threats—especially if the training data was incomplete or biased.</p><p data-start="3727" data-end="3920">Also, ML models aren’t good at explaining <em data-start="3769" data-end="3774">why</em> they flagged something as suspicious. That “black box” nature can frustrate analysts who need to justify decisions to stakeholders or regulators.</p><p data-start="3922" data-end="4132">So no—it’s not replacing human cybersecurity teams. It’s augmenting them. Ideally, the machines catch things faster and earlier, while the humans make the final calls, investigate deeply, and decide on actions.</p><h2 id="mcetoc_1iq8h54te1ab" data-start="4139" data-end="4184">Types of Machine Learning in Cybersecurity</h2><p data-start="4186" data-end="4296">Here’s where we briefly dip into the technical weeds. Not too deep, though—just enough to make things clearer.</p><h3 id="mcetoc_1iq8h54te1ac" data-start="4298" data-end="4328">1. <strong data-start="4305" data-end="4328">Supervised Learning</strong></h3><p data-start="4329" data-end="4475">This is where models are trained on labeled data. Think “this is malware, this is not.” It works well when there’s lots of clean, historical data.</p><p data-start="4477" data-end="4550"><strong data-start="4477" data-end="4490">Used for:</strong> Spam filtering, phishing detection, malware classification.</p><h3 id="mcetoc_1iq8h54te1ad" data-start="4552" data-end="4584">2. <strong data-start="4559" data-end="4584">Unsupervised Learning</strong></h3><p data-start="4585" data-end="4742">There’s no labeled data here. The model looks for patterns or clusters on its own. This is particularly helpful when spotting new, never-before-seen threats.</p><p data-start="4744" data-end="4802"><strong data-start="4744" data-end="4757">Used for:</strong> Anomaly detection, insider threat detection.</p><h3 id="mcetoc_1iq8h54te1ae" data-start="4804" data-end="4837">3. <strong data-start="4811" data-end="4837">Reinforcement Learning</strong></h3><p data-start="4838" data-end="4953">Less common but emerging. The model learns through trial and error, optimizing actions over time based on feedback.</p><p data-start="4955" data-end="5022"><strong data-start="4955" data-end="4968">Used for:</strong> Dynamic honeypots, autonomous threat hunting systems.</p><p data-start="5024" data-end="5141">Each has pros and cons, and real-world systems often use a hybrid approach. It’s rarely just one method in isolation.</p><h2 id="mcetoc_1iq8h54te1af" data-start="5148" data-end="5173">Why Now? What Changed?</h2><p data-start="5175" data-end="5302">Machine learning has technically been around since the mid-20th century. So why the boom in cybersecurity only in recent years?</p><p data-start="5304" data-end="5318">A few reasons:</p><ul data-start="5319" data-end="5788"><li data-start="5319" data-end="5437"><p data-start="5321" data-end="5437"><strong data-start="5321" data-end="5343">Data availability.</strong> There’s finally enough data (logs, telemetry, attack signatures) to train models effectively.</p></li><li data-start="5438" data-end="5559"><p data-start="5440" data-end="5559"><strong data-start="5440" data-end="5460">Cloud computing.</strong> ML models require massive processing power. The rise of cloud infrastructure made that affordable.</p></li><li data-start="5560" data-end="5643"><p data-start="5562" data-end="5643"><strong data-start="5562" data-end="5579">AI arms race.</strong> Attackers are using automation too—forcing defenders to evolve.</p></li><li data-start="5644" data-end="5788"><p data-start="5646" data-end="5788"><strong data-start="5646" data-end="5671">Budget justification.</strong> As breaches become more costly (think millions per incident), companies are more willing to invest in next-gen tech.</p></li></ul><p data-start="5790" data-end="5870">So it’s a mix of technological readiness, economic pressure, and, frankly, fear.</p><h2 id="mcetoc_1iq8h54te1ag" data-start="5877" data-end="5928">A Day in the Life of AI-Powered Threat Detection</h2><p data-start="5930" data-end="6025">To put this into perspective, let’s imagine how an AI-enabled system might respond to a threat:</p><ol data-start="6027" data-end="6655"><li data-start="6027" data-end="6151"><p data-start="6030" data-end="6151"><strong data-start="6030" data-end="6054">Unusual Login Alert:</strong> The system notices that a user has logged in from two countries within 5 minutes. That’s... odd.</p></li><li data-start="6152" data-end="6252"><p data-start="6155" data-end="6252"><strong data-start="6155" data-end="6175">Anomaly Scoring:</strong> It compares this to past user behavior and flags it as a high anomaly score.</p></li><li data-start="6253" data-end="6399"><p data-start="6256" data-end="6399"><strong data-start="6256" data-end="6284">Cross-checking Behavior:</strong> It also detects that this user just attempted to access a sensitive financial folder they've never touched before.</p></li><li data-start="6400" data-end="6531"><p data-start="6403" data-end="6531"><strong data-start="6403" data-end="6414">Action:</strong> Depending on configuration, the system might lock the account, require MFA, or notify the security team immediately.</p></li><li data-start="6532" data-end="6655"><p data-start="6535" data-end="6655"><strong data-start="6535" data-end="6548">Learning:</strong> If the security team confirms this was a genuine threat, that feedback improves future detection accuracy.</p></li></ol><p data-start="6657" data-end="6841">Now multiply that by thousands of users and hundreds of endpoints, and you get a sense of how ML helps scale detection across environments that are simply too complex for humans alone.</p><h2 id="mcetoc_1iq8h54te1ah" data-start="6848" data-end="6883">Benefits That Are Hard to Ignore</h2><ul data-start="6885" data-end="7194"><li data-start="6885" data-end="6954"><p data-start="6887" data-end="6954"><strong data-start="6887" data-end="6897">Speed:</strong> Threats can be detected and mitigated in near real-time.</p></li><li data-start="6955" data-end="7039"><p data-start="6957" data-end="7039"><strong data-start="6957" data-end="6973">Scalability:</strong> Works across millions of endpoints, log files, and traffic flows.</p></li><li data-start="7040" data-end="7106"><p data-start="7042" data-end="7106"><strong data-start="7042" data-end="7068">Reduced Alert Fatigue:</strong> ML helps prioritize the real threats.</p></li><li data-start="7107" data-end="7194"><p data-start="7109" data-end="7194"><strong data-start="7109" data-end="7129">Early Detection:</strong> Behavioral analysis often catches threats before damage is done.</p></li></ul><p data-start="7196" data-end="7254">Honestly, it’s hard to imagine modern security without it.</p><h2 id="mcetoc_1iq8h54te1ai" data-start="7261" data-end="7313">Risks and Limitations (Because, Let’s Be Honest…)</h2><ul data-start="7315" data-end="7742"><li data-start="7315" data-end="7412"><p data-start="7317" data-end="7412"><strong data-start="7317" data-end="7341">Adversarial Attacks:</strong> Yes, attackers can manipulate ML models by feeding them poisoned data.</p></li><li data-start="7413" data-end="7505"><p data-start="7415" data-end="7505"><strong data-start="7415" data-end="7435">False Positives:</strong> These still happen. Overly sensitive models may flag normal activity.</p></li><li data-start="7506" data-end="7636"><p data-start="7508" data-end="7636"><strong data-start="7508" data-end="7534">Bias in Training Data:</strong> If the model is trained on narrow or outdated datasets, it may underperform in real-world conditions.</p></li><li data-start="7637" data-end="7742"><p data-start="7639" data-end="7742"><strong data-start="7639" data-end="7663">Cost and Complexity:</strong> Implementing AI systems isn’t plug-and-play. It takes time, people, and money.</p></li></ul><p data-start="7744" data-end="7830">So it’s not a silver bullet. But it’s probably the best arrow in the quiver right now.</p><h2 id="mcetoc_1iq8h54te1aj" data-start="7837" data-end="7878">Future Outlook: Where Is This Heading?</h2><p data-start="7880" data-end="7946">Here’s where things get a little speculative—but also interesting.</p><h3 id="mcetoc_1iq8h54te1ak" data-start="7948" data-end="7979">1. <strong data-start="7955" data-end="7979">Self-Healing Systems</strong></h3><p data-start="7980" data-end="8110">Imagine systems that not only detect and block threats but automatically patch vulnerabilities or reroute traffic to avoid damage.</p><h3 id="mcetoc_1iq8h54te1al" data-start="8112" data-end="8131">2. <strong data-start="8119" data-end="8131">AI vs AI</strong></h3><p data-start="8132" data-end="8370">As attackers use generative AI to create phishing emails, deepfake credentials, or fake access requests, defenders will use AI to detect inconsistencies. It’s like a cyber version of chess—only faster, messier, and with real-world stakes.</p><h3 id="mcetoc_1iq8h54te1am" data-start="8372" data-end="8403">3. <strong data-start="8379" data-end="8403">Explainable AI (XAI)</strong></h3><p data-start="8404" data-end="8585">As regulators demand transparency, future systems will likely evolve to explain <em data-start="8484" data-end="8489">why</em> a threat was flagged, not just <em data-start="8521" data-end="8527">that</em> it was. That’s a big step forward in trust and usability.</p><h2 id="mcetoc_1iq8h54te1an" data-start="8592" data-end="8638">Final Thoughts: This Isn’t Optional Anymore</h2><p data-start="8640" data-end="8938">Machine learning in threat detection isn’t some extra feature for large corporations—it’s quickly becoming a baseline expectation. As attack surfaces expand with remote work, cloud apps, IoT devices, and shadow IT, the only way to manage risk at scale is with systems that learn, adapt, and evolve.</p><p data-start="8940" data-end="8988">It’s a shift. Not just in tools, but in mindset.</p><p data-start="8990" data-end="9077">Because if attackers are evolving, staying static isn’t just unwise—it’s irresponsible.</p><h2 id="mcetoc_1iq8h54te1ao" data-start="9084" data-end="9096">Quick FAQ</h2><p data-start="9098" data-end="9254"><strong data-start="9098" data-end="9149">Q: Does ML replace cybersecurity professionals?</strong><br data-start="9149" data-end="9152">Nope. It supports them. Humans still make the big calls, handle investigations, and fine-tune systems.</p><p data-start="9256" data-end="9432"><strong data-start="9256" data-end="9309">Q: Is this stuff affordable for small businesses?</strong><br data-start="9309" data-end="9312">Increasingly, yes. Many cloud-based platforms offer ML-powered tools on a per-seat basis or as part of managed services.</p><p data-start="9434" data-end="9683"><strong data-start="9434" data-end="9463">Q: How can I get started?</strong><br data-start="9463" data-end="9466">Start with platforms like Microsoft Defender, Cisco SecureX, or open-source options like Wazuh (with ML integrations). Even something like Gmail uses ML to block phishing daily—so chances are, you’re already using it.</p></div><footer><p class="content__last-updated"><time datetime="2025-05-02T13:30">This article was updated on May 2, 2025</time></p><nav class="content__nav"><div class="content__nav__prev"><a class="content__nav__link" href="https://leonstaff.com/blogs/how-ai-detects-phishing.html" rel="prev">Previous Post<h3 class="h6">How AI Detects Phishing: A Beginner’s Guide to Smarter Cybersecurity</h3></a></div><div class="content__nav__next"><a class="content__nav__link" href="https://leonstaff.com/blogs/ar-remote-collaboration-2025.html" rel="prev">Next Post<h3 class="h6">AR for Remote Collaboration: How Teams Are Using Augmented Reality in 2025</h3></a></div></nav></footer></div></article></div></main><footer class="footer"><nav><ul class="footer__nav"><li class="footer__nav-item"><a href="https://leonstaff.com" target="_self">HOME</a></li><li class="footer__nav-item"><a href="https://leonstaff.com/#services" target="_self">SERVICES</a></li><li class="footer__nav-item"><a href="https://leonstaff.com/#about" target="_self">ABOUT</a></li><li class="footer__nav-item"><a href="https://leonstaff.com/#contact" target="_self">CONTACT</a></li><li class="footer__nav-item"><a href="https://leonstaff.com/#faq" target="_self">F&amp;Q</a></li></ul></nav><div class="footer__copyright">Powered by Leon Consulting Corporation</div></footer><script>window.publiiThemeMenuConfig = {    
      mobileMenuMode: 'sidebar',
      animationSpeed: 300,
      submenuWidth: 'auto',
      doubleClickTime: 500,
      mobileMenuExpandableSubmenus: true, 
      relatedContainerForOverlayMenuSelector: '.navbar',
   };</script><script defer="defer" src="https://leonstaff.com/blogs/assets/js/scripts.min.js?v=1b09dc64eb6086ddc9720890661ff038"></script><div class="pcb" data-behaviour="badge" data-behaviour-link="#cookie-settings" data-revision="1" data-config-ttl="90" data-debug-mode="false"><div role="dialog" aria-modal="true" aria-hidden="true" aria-labelledby="pcb-title" aria-describedby="pcb-txt" class="pcb__banner"><div class="pcb__inner"><div id="pcb-title" role="heading" aria-level="2" class="pcb__title">This website uses cookies</div><div id="pcb-txt" class="pcb__txt">Select which cookies to opt-in to via the checkboxes below; our website uses cookies to examine site traffic and user activity while on our site, for marketing, and to provide social media functionality. <a href="#not-specified">More details...</a></div><div class="pcb__buttons"><button type="button" class="pcb__btn pcb__btn--link pcb__btn--configure" aria-haspopup="dialog">Manage preferences</button> <button type="button" class="pcb__btn pcb__btn--solid pcb__btn--accept">Accept all</button></div></div></div><div class="pcb__popup" role="dialog" aria-modal="true" aria-hidden="true" aria-labelledby="pcb-popup-title"><div class="pcb__popup__wrapper"><div class="pcb__inner pcb__popup__inner"><div class="pcb__popup__heading"><div id="pcb-popup-title" role="heading" aria-level="2" class="pcb__title">Cookie settings</div><button class="pcb__popup__close" aria-label="Close"></button></div><div class="pcb__popup__content"><div class="pcb__txt pcb__popup__txt">We use cookies to enhance your browsing experience, serve personalized ads or content, and analyze our traffic. By clicking "Accept All", you consent to our use of cookies. <a href="#not-specified">More details...</a></div><ul class="pcb__groups"><li class="pcb__group"><details><summary class="pcb__group__title no-desc">Required</summary></details><div class="pcb__popup__switch is-checked"><input type="checkbox" data-group-name="" id="pcb-group-0" checked="checked"> <label for="pcb-group-0">Required</label></div></li></ul></div><div class="pcb__buttons pcb__popup__buttons"><button type="button" class="pcb__btn pcb__btn--solid pcb__btn--accept">Accept all</button> <button type="button" class="pcb__btn pcb__btn--reject">Reject all</button> <button type="button" class="pcb__btn pcb__btn--save">Save settings</button></div></div></div></div><div class="pcb__overlay" aria-hidden="true"></div><button class="pcb__badge" aria-label="Cookie Policy" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" width="40" height="40" viewBox="0 0 23 23" fill="currentColor"><path d="M21.41 12.71c-.08-.01-.15 0-.22 0h-.03c-.03 0-.05 0-.08.01-.07 0-.13.01-.19.04-.52.21-1.44.19-2.02-.22-.44-.31-.65-.83-.62-1.53a.758.758 0 0 0-.27-.61.73.73 0 0 0-.65-.14c-1.98.51-3.49.23-4.26-.78-.82-1.08-.73-2.89.24-4.49.14-.23.14-.52 0-.75a.756.756 0 0 0-.67-.36c-.64.03-1.11-.1-1.31-.35-.19-.26-.13-.71-.01-1.29.04-.18.06-.38.03-.59-.05-.4-.4-.7-.81-.66C5.1 1.54 1 6.04 1 11.48 1 17.28 5.75 22 11.6 22c5.02 0 9.39-3.54 10.39-8.42.08-.4-.18-.78-.58-.87Zm-9.81 7.82c-5.03 0-9.12-4.06-9.12-9.06 0-4.34 3.05-8 7.25-8.86-.08.7.05 1.33.42 1.81.24.32.66.67 1.38.84-.76 1.86-.65 3.78.36 5.11.61.81 2.03 2 4.95 1.51.18.96.71 1.54 1.18 1.87.62.43 1.38.62 2.1.62.05 0 .09 0 .13-.01-1.23 3.64-4.7 6.18-8.64 6.18ZM13 17c0 .55-.45 1-1 1s-1-.45-1-1 .45-1 1-1 1 .45 1 1Zm5.29-12.3a.99.99 0 0 1-.29-.71c0-.55.45-.99 1-.99a1 1 0 0 1 .71.3c.19.19.29.44.29.71 0 .55-.45.99-1 .99a1 1 0 0 1-.71-.3ZM9 13.5c0 .83-.67 1.5-1.5 1.5S6 14.33 6 13.5 6.67 12 7.5 12s1.5.67 1.5 1.5Zm3.25.81a.744.744 0 0 1-.06-1.05c.28-.32.75-.34 1.05-.06.31.28.33.75.05 1.06-.15.16-.35.25-.56.25-.18 0-.36-.06-.5-.19ZM8.68 7.26c.41.37.44 1 .07 1.41-.2.22-.47.33-.75.33a.96.96 0 0 1-.67-.26c-.41-.37-.44-1-.07-1.41.37-.42 1-.45 1.41-.08Zm11.48 1.88c.18-.19.52-.19.7 0 .05.04.09.1.11.16.03.06.04.12.04.19 0 .13-.05.26-.15.35-.09.1-.22.15-.35.15s-.26-.05-.35-.15a.355.355 0 0 1-.11-.16.433.433 0 0 1-.04-.19c0-.13.05-.26.15-.35Zm-4.93-1.86a.75.75 0 1 1 1.059-1.06.75.75 0 0 1-1.059 1.06Z"/></svg></button></div><script>(function(win) {
    if (!document.querySelector('.pcb')) {
        return;
    }

    var cbConfig = {
        behaviour: document.querySelector('.pcb').getAttribute('data-behaviour'),
        behaviourLink: document.querySelector('.pcb').getAttribute('data-behaviour-link'),
        revision: document.querySelector('.pcb').getAttribute('data-revision'),
        configTTL: parseInt(document.querySelector('.pcb').getAttribute('data-config-ttl'), 10),
        debugMode: document.querySelector('.pcb').getAttribute('data-debug-mode') === 'true',
        initialState: null,
        initialLsState: null,
        previouslyAccepted: []
    };

    var cbUI = {
        wrapper: document.querySelector('.pcb'),
        banner: {
            element: null,
            btnAccept: null,
            btnReject: null,
            btnConfigure: null
        },
        popup: {
            element: null,
            btnClose: null,
            btnSave: null,
            btnAccept: null,
            btnReject: null,
            checkboxes: null,
        },
        overlay: null,
        badge: null,
        blockedScripts: document.querySelectorAll('script[type^="gdpr-blocker/"]'),
        triggerLinks: cbConfig.behaviourLink ? document.querySelectorAll('a[href*="' + cbConfig.behaviourLink + '"]') : null
    };

    function initUI () {
        // setup banner elements
        cbUI.banner.element = cbUI.wrapper.querySelector('.pcb__banner');
        cbUI.banner.btnAccept = cbUI.banner.element.querySelector('.pcb__btn--accept');
        cbUI.banner.btnReject = cbUI.banner.element.querySelector('.pcb__btn--reject');
        cbUI.banner.btnConfigure = cbUI.banner.element.querySelector('.pcb__btn--configure');

        // setup popup elements
        if (cbUI.wrapper.querySelector('.pcb__popup')) {
            cbUI.popup.element = cbUI.wrapper.querySelector('.pcb__popup');
            cbUI.popup.btnClose = cbUI.wrapper.querySelector('.pcb__popup__close');
            cbUI.popup.btnSave = cbUI.popup.element.querySelector('.pcb__btn--save');
            cbUI.popup.btnAccept = cbUI.popup.element.querySelector('.pcb__btn--accept');
            cbUI.popup.btnReject = cbUI.popup.element.querySelector('.pcb__btn--reject');
            cbUI.popup.checkboxes = cbUI.popup.element.querySelector('input[type="checkbox"]');
            // setup overlay
            cbUI.overlay = cbUI.wrapper.querySelector('.pcb__overlay');
        }

        cbUI.badge = cbUI.wrapper.querySelector('.pcb__badge');

        if (cbConfig.behaviour.indexOf('link') > -1) {
            for (var i = 0; i < cbUI.triggerLinks.length; i++) {
                cbUI.triggerLinks[i].addEventListener('click', function(e) {
                    e.preventDefault();
                    showBannerOrPopup();
                });
            }
        }
    }

    function initState () {
        var lsKeyName = getConfigName();
        var currentConfig = localStorage.getItem(lsKeyName);
        var configIsFresh = checkIfConfigIsFresh();

        if (!configIsFresh || currentConfig === null) {
            if (cbConfig.debugMode) {
                console.log('🍪 Config not found, or configuration expired');
            }

            if (window.publiiCBGCM) {
                gtag('consent', 'default', {
                    'ad_storage': window.publiiCBGCM.defaultState.ad_storage ? 'granted' : 'denied',
                    'ad_personalization': window.publiiCBGCM.defaultState.ad_personalization ? 'granted' : 'denied',
                    'ad_user_data': window.publiiCBGCM.defaultState.ad_user_data ? 'granted' : 'denied',
                    'analytics_storage': window.publiiCBGCM.defaultState.analytics_storage ? 'granted' : 'denied',
                    'personalization_storage': window.publiiCBGCM.defaultState.personalization_storage ? 'granted' : 'denied',
                    'functionality_storage': window.publiiCBGCM.defaultState.functionality_storage ? 'granted' : 'denied',
                    'security_storage': window.publiiCBGCM.defaultState.security_storage ? 'granted' : 'denied'
                });  
                
                if (cbConfig.debugMode) {
                    console.log('🍪 GCMv2 DEFAULT STATE: ' + JSON.stringify({
                        'ad_storage': window.publiiCBGCM.defaultState.ad_storage ? 'granted' : 'denied',
                        'ad_personalization': window.publiiCBGCM.defaultState.ad_personalization ? 'granted' : 'denied',
                        'ad_user_data': window.publiiCBGCM.defaultState.ad_user_data ? 'granted' : 'denied',
                        'analytics_storage': window.publiiCBGCM.defaultState.analytics_storage ? 'granted' : 'denied',
                        'personalization_storage': window.publiiCBGCM.defaultState.personalization_storage ? 'granted' : 'denied',
                        'functionality_storage': window.publiiCBGCM.defaultState.functionality_storage ? 'granted' : 'denied',
                        'security_storage': window.publiiCBGCM.defaultState.security_storage ? 'granted' : 'denied'
                    }));
                }
            }

            showBanner();
        } else if (typeof currentConfig === 'string') {
            if (cbConfig.debugMode) {
                console.log('🍪 Config founded');
            }

            cbConfig.initialLsState = currentConfig.split(',');

            if (window.publiiCBGCM) {
                gtag('consent', 'default', {
                    'ad_storage': getDefaultConsentState(currentConfig, 'ad_storage'),
                    'ad_personalization': getDefaultConsentState(currentConfig, 'ad_personalization'),
                    'ad_user_data': getDefaultConsentState(currentConfig, 'ad_user_data'),
                    'analytics_storage': getDefaultConsentState(currentConfig, 'analytics_storage'),
                    'personalization_storage': getDefaultConsentState(currentConfig, 'personalization_storage'),
                    'functionality_storage': getDefaultConsentState(currentConfig, 'functionality_storage'),
                    'security_storage': getDefaultConsentState(currentConfig, 'security_storage')
                });
                
                if (cbConfig.debugMode) {
                    console.log('🍪 GCMv2 DEFAULT STATE: ' + JSON.stringify({
                        'ad_storage': getDefaultConsentState(currentConfig, 'ad_storage'),
                        'ad_personalization': getDefaultConsentState(currentConfig, 'ad_personalization'),
                        'ad_user_data': getDefaultConsentState(currentConfig, 'ad_user_data'),
                        'analytics_storage': getDefaultConsentState(currentConfig, 'analytics_storage'),
                        'personalization_storage': getDefaultConsentState(currentConfig, 'personalization_storage'),
                        'functionality_storage': getDefaultConsentState(currentConfig, 'functionality_storage'),
                        'security_storage': getDefaultConsentState(currentConfig, 'security_storage')
                    }));
                }
            }

            showBadge();

            if (cbUI.popup.element) {
                var allowedGroups = currentConfig.split(',');
                var checkedCheckboxes = cbUI.popup.element.querySelectorAll('input[type="checkbox"]:checked');

                for (var j = 0; j < checkedCheckboxes.length; j++) {
                    var name = checkedCheckboxes[j].getAttribute('data-group-name');

                    if (name && name !== '-' && allowedGroups.indexOf(name) === -1) {
                        checkedCheckboxes[j].checked = false;
                    }
                }

                for (var i = 0; i < allowedGroups.length; i++) {
                    var checkbox = cbUI.popup.element.querySelector('input[type="checkbox"][data-group-name="' + allowedGroups[i] + '"]');

                    if (checkbox) {
                        checkbox.checked = true;
                    }

                    allowCookieGroup(allowedGroups[i]);
                }
            }
        }

        setTimeout(function () {
            cbConfig.initialState = getInitialStateOfConsents();
        }, 0);
    }

    function checkIfConfigIsFresh () {
        var lastConfigSave = localStorage.getItem('publii-gdpr-cookies-config-save-date');

        if (lastConfigSave === null) {
            return false;
        }

        lastConfigSave = parseInt(lastConfigSave, 10);

        if (lastConfigSave === 0) {
            return true;
        }

        if (+new Date() - lastConfigSave < cbConfig.configTTL * 24 * 60 * 60 * 1000) {
            return true;
        }

        return false;
    }

    function getDefaultConsentState (currentConfig, consentGroup) {
        let configGroups = currentConfig.split(',');

        for (let i = 0; i < configGroups.length; i++) {
            let groupName = configGroups[i];
            let group = window.publiiCBGCM.groups.find(group => group.cookieGroup === groupName);

            if (group && group[consentGroup]) {
                return 'granted';
            }
        }  
        
        if (window.publiiCBGCM.defaultState[consentGroup]) {
            return 'granted'; 
        }
        
        return 'denied';
    }

    function initBannerEvents () {
        cbUI.banner.btnAccept.addEventListener('click', function (e) {
            e.preventDefault();
            acceptAllCookies('banner');
            showBadge();
        }, false);

        if (cbUI.banner.btnReject) {
            cbUI.banner.btnReject.addEventListener('click', function (e) {
                e.preventDefault();
                rejectAllCookies();
                showBadge();
            }, false);
        }

        if (cbUI.banner.btnConfigure) {
            cbUI.banner.btnConfigure.addEventListener('click', function (e) {
                e.preventDefault();
                hideBanner();
                showAdvancedPopup();
                showBadge();
            }, false);
        }
    }

    function initPopupEvents () {
        if (!cbUI.popup.element) {
            return;
        }

        cbUI.overlay.addEventListener('click', function (e) {
            hideAdvancedPopup();
        }, false);

        cbUI.popup.element.addEventListener('click', function (e) {
            e.stopPropagation();
        }, false);

        cbUI.popup.btnAccept.addEventListener('click', function (e) {
            e.preventDefault();
            acceptAllCookies('popup');
        }, false);

        cbUI.popup.btnReject.addEventListener('click', function (e) {
            e.preventDefault();
            rejectAllCookies();
        }, false);

        cbUI.popup.btnSave.addEventListener('click', function (e) {
            e.preventDefault();
            saveConfiguration();
        }, false);

        cbUI.popup.btnClose.addEventListener('click', function (e) {
            e.preventDefault();
            hideAdvancedPopup();
        }, false);
    }

    function initBadgeEvents () {
        if (!cbUI.badge) {
            return;
        }

        cbUI.badge.addEventListener('click', function (e) {
            showBannerOrPopup();
        }, false);
    }

    initUI();
    initState();
    initBannerEvents();
    initPopupEvents();
    initBadgeEvents();

    /**
     * API
     */
    function addScript (src, inline) {
        var newScript = document.createElement('script');

        if (src) {
            newScript.setAttribute('src', src);
        }

        if (inline) {
            newScript.text = inline;
        }

        document.body.appendChild(newScript);
    }

    function allowCookieGroup (allowedGroup) {
        var scripts = document.querySelectorAll('script[type="gdpr-blocker/' + allowedGroup + '"]');
        cbConfig.previouslyAccepted.push(allowedGroup);
    
        for (var j = 0; j < scripts.length; j++) {
            addScript(scripts[j].src, scripts[j].text);
        }

        var groupEvent = new Event('publii-cookie-banner-unblock-' + allowedGroup);
        document.body.dispatchEvent(groupEvent);
        unlockEmbeds(allowedGroup);

        if (cbConfig.debugMode) {
            console.log('🍪 Allowed group: ' + allowedGroup);
        }

        if (window.publiiCBGCM && (!cbConfig.initialLsState || cbConfig.initialLsState.indexOf(allowedGroup) === -1)) {
            let consentResult = {};
            let group = window.publiiCBGCM.groups.find(group => group.cookieGroup === allowedGroup);

            if (group) {
                let foundSomeConsents = false;

                Object.keys(group).forEach(key => {
                    if (key !== 'cookieGroup' && group[key] === true) {
                        consentResult[key] = 'granted';
                        foundSomeConsents = true;
                    }
                });

                if (foundSomeConsents) {
                    gtag('consent', 'update', consentResult);   

                    if (cbConfig.debugMode) {
                        console.log('🍪 GCMv2 UPDATE: ' + JSON.stringify(consentResult));
                    }
                }
            }
        }
    }

    function showBannerOrPopup () {
        if (cbUI.popup.element) {
            showAdvancedPopup();
        } else {
            showBanner();
        }
    }

    function showAdvancedPopup () {
        cbUI.popup.element.classList.add('is-visible');
        cbUI.overlay.classList.add('is-visible');
        cbUI.popup.element.setAttribute('aria-hidden', 'false');
        cbUI.overlay.setAttribute('aria-hidden', 'false');
    }

    function hideAdvancedPopup () {
        cbUI.popup.element.classList.remove('is-visible');
        cbUI.overlay.classList.remove('is-visible');
        cbUI.popup.element.setAttribute('aria-hidden', 'true');
        cbUI.overlay.setAttribute('aria-hidden', 'true');
    }

    function showBanner () {
        cbUI.banner.element.classList.add('is-visible');
        cbUI.banner.element.setAttribute('aria-hidden', 'false');
    }

    function hideBanner () {
        cbUI.banner.element.classList.remove('is-visible');
        cbUI.banner.element.setAttribute('aria-hidden', 'true');
    }

    function showBadge () {
        if (!cbUI.badge) {
            return;
        }

        cbUI.badge.classList.add('is-visible');
        cbUI.badge.setAttribute('aria-hidden', 'false');
    }

    function getConfigName () {
        var lsKeyName = 'publii-gdpr-allowed-cookies';

        if (cbConfig.revision) {
            lsKeyName = lsKeyName + '-v' + parseInt(cbConfig.revision, 10);
        }

        return lsKeyName;
    }

    function storeConfiguration (allowedGroups) {
        var lsKeyName = getConfigName();
        var dataToStore = allowedGroups.join(',');
        localStorage.setItem(lsKeyName, dataToStore);

        if (cbConfig.configTTL === 0) {
            localStorage.setItem('publii-gdpr-cookies-config-save-date', 0);

            if (cbConfig.debugMode) {
                console.log('🍪 Store never expiring configuration');
            }
        } else {
            localStorage.setItem('publii-gdpr-cookies-config-save-date', +new Date());
        }
    }

    function getInitialStateOfConsents () {
        if (!cbUI.popup.element) {
            return [];
        }

        var checkedGroups = cbUI.popup.element.querySelectorAll('input[type="checkbox"]:checked');
        var groups = [];

        for (var i = 0; i < checkedGroups.length; i++) {
            var allowedGroup = checkedGroups[i].getAttribute('data-group-name');

            if (allowedGroup !== '') {
                groups.push(allowedGroup);
            }
        }

        if (cbConfig.debugMode) {
            console.log('🍪 Initial state: ' + groups.join(', '));
        }

        return groups;
    }

    function getCurrentStateOfConsents () {
        if (!cbUI.popup.element) {
            return [];
        }

        var checkedGroups = cbUI.popup.element.querySelectorAll('input[type="checkbox"]:checked');
        var groups = [];

        for (var i = 0; i < checkedGroups.length; i++) {
            var allowedGroup = checkedGroups[i].getAttribute('data-group-name');

            if (allowedGroup !== '') {
                groups.push(allowedGroup);
            }
        }

        if (cbConfig.debugMode) {
            console.log('🍪 State to save: ' + groups.join(', '));
        }

        return groups;
    }

    function getAllGroups () {
        if (!cbUI.popup.element) {
            return [];
        }

        var checkedGroups = cbUI.popup.element.querySelectorAll('input[type="checkbox"]');
        var groups = [];

        for (var i = 0; i < checkedGroups.length; i++) {
            var allowedGroup = checkedGroups[i].getAttribute('data-group-name');

            if (allowedGroup !== '') {
                groups.push(allowedGroup);
            }
        }

        return groups;
    }

    function acceptAllCookies (source) {
        var groupsToAccept = getAllGroups();
        storeConfiguration(groupsToAccept);

        for (var i = 0; i < groupsToAccept.length; i++) {
            var group = groupsToAccept[i];

            if (cbConfig.initialState.indexOf(group) > -1 || cbConfig.previouslyAccepted.indexOf(group) > -1) {
                if (cbConfig.debugMode) {
                    console.log('🍪 Skip previously activated group: ' + group);
                }

                continue;
            }

            allowCookieGroup(group);
        }

        if (cbUI.popup.element) {
            var checkboxesToCheck = cbUI.popup.element.querySelectorAll('input[type="checkbox"]');

            for (var j = 0; j < checkboxesToCheck.length; j++) {
                checkboxesToCheck[j].checked = true;
            }
        }

        if (cbConfig.debugMode) {
            console.log('🍪 Accept all cookies: ', groupsToAccept.join(', '));
        }

        if (source === 'popup') {
            hideAdvancedPopup();
        } else if (source === 'banner') {
            hideBanner();
        }
    }

    function rejectAllCookies () {
        if (cbConfig.debugMode) {
            console.log('🍪 Reject all cookies');
        }

        storeConfiguration([]);
        setTimeout(function () {
            window.location.reload();
        }, 100);
    }

    function saveConfiguration () {
        var groupsToAccept = getCurrentStateOfConsents();
        storeConfiguration(groupsToAccept);

        if (cbConfig.debugMode) {
            console.log('🍪 Save new config: ', groupsToAccept.join(', '));
        }

        if (reloadIsNeeded(groupsToAccept)) {
            setTimeout(function () {
                window.location.reload();
            }, 100);
            return;
        }

        for (var i = 0; i < groupsToAccept.length; i++) {
            var group = groupsToAccept[i];

            if (cbConfig.initialState.indexOf(group) > -1 || cbConfig.previouslyAccepted.indexOf(group) > -1) {
                if (cbConfig.debugMode) {
                    console.log('🍪 Skip previously activated group: ' + group);
                }

                continue;
            }

            allowCookieGroup(group);
        }

        hideAdvancedPopup();
    }

    function reloadIsNeeded (groupsToAccept) {
        // check if user rejected consent for initial groups
        var initialGroups = cbConfig.initialState;
        var previouslyAcceptedGroups = cbConfig.previouslyAccepted;
        var groupsToCheck = initialGroups.concat(previouslyAcceptedGroups);

        for (var i = 0; i < groupsToCheck.length; i++) {
            var groupToCheck = groupsToCheck[i];

            if (groupToCheck !== '' && groupsToAccept.indexOf(groupToCheck) === -1) {
                if (cbConfig.debugMode) {
                    console.log('🍪 Reload is needed due lack of: ', groupToCheck);
                }

                return true;
            }
        }

        return false;
    }

    function unlockEmbeds (cookieGroup) {
        var iframesToUnlock = document.querySelectorAll('.pec-wrapper[data-consent-group-id="' + cookieGroup + '"]');

        for (var i = 0; i < iframesToUnlock.length; i++) {
            var iframeWrapper = iframesToUnlock[i];
            iframeWrapper.querySelector('.pec-overlay').classList.remove('is-active');
            iframeWrapper.querySelector('.pec-overlay').setAttribute('aria-hidden', 'true');
            var iframe = iframeWrapper.querySelector('iframe');
            iframe.setAttribute('src', iframe.getAttribute('data-consent-src'));
        }
    }

    win.publiiEmbedConsentGiven = function (cookieGroup) {
        // it will unlock embeds
        allowCookieGroup(cookieGroup);

        var checkbox = cbUI.popup.element.querySelector('input[type="checkbox"][data-group-name="' + cookieGroup + '"]');

        if (checkbox) {
            checkbox.checked = true;
        }

        var groupsToAccept = getCurrentStateOfConsents();
        storeConfiguration(groupsToAccept);

        if (cbConfig.debugMode) {
            console.log('🍪 Save new config: ', groupsToAccept.join(', '));
        }
    }
})(window);</script></body></html>